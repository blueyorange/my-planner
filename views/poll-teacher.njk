{% set title="Teacher Poll" %}
{% extends "base.njk" %}
{% block head %}
    {{ super() }} <link rel="stylesheet" href="/css/poll.css"/>
    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        const joinCode = window
            .location
            .href
            .split('/')
            .pop();
        socket.emit('join', joinCode)
        socket.on('names', (names) => {
            console.log(names);
            console
                .log (`${
                    names.length
                } in room`)
                document
                .querySelector('#join-status')
                .innerHTML = `${
                names.length
            } in room`;
            document.querySelector('#student-list').innerHTML = names.map(
                name => `<span class="badge rounded-pill bg-primary">${
                    name
                }</span>`
            ).reduce((acc, curr) => acc += curr, []);
        });
    </script>
{% endblock %}
{% block content %}
    <div class="d-flex justify-content-between">
        <h2>{{ joinUrl }}/{{ joinCode }}</h2>
        <h2 id="join-status"></h2>
    </div>
</div>
<div class="row">
    <div class="question">
        <div class="body">
            {{ parse(q.body) | safe }}
        </div>
        <div class="options">
            {% for option in q.options %}
                <div class="option p-3 m-2">
                    {{ parse(option) | safe }}
                </div>
            {% endfor %}
        </div>
        <div id="student-list"></div>
    </div>
</div>{% endblock %}